!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core"),require("@angular/router"),require("@angular/platform-browser"),require("@angular/common")):"function"==typeof define&&define.amd?define(["exports","@angular/core","@angular/router","@angular/platform-browser","@angular/common"],t):t((e.ng2=e.ng2||{},e.ng2.page=e.ng2.page||{},e.ng2.page.scroll=e.ng2.page.scroll||{}),e.ng.core,e.ng.router,e.ng.platform-browser,e.ng.common)}(this,function(e,t,n,r,o){"use strict";var i=function(){function e(){}return e}(),l=function(){function e(){}return Object.defineProperty(e,"defaultEasingLogic",{get:function(){return e._easingLogic},set:function(t){e._easingLogic=t},enumerable:!0,configurable:!0}),e._interval=10,e._defaultNamespace="default",e.defaultDuration=1250,e.defaultScrollOffset=0,e._interruptEvents=["mousedown","wheel","DOMMouseScroll","mousewheel","keyup","touchmove"],e._interruptKeys=[33,34,35,36,38,40],e.defaultInterruptible=!0,e._easingLogic={ease:function(e,t,n,r){return n*e/r+t}},e}(),s=function(){function e(){}return e.isUndefinedOrNull=function(e){return"undefined"==typeof e||void 0===e||null===e},e.extractElementPosition=function(t,n){var r=t.body,o=t.documentElement,i=t.defaultView&&t.defaultView.pageYOffset||void 0,l=t.defaultView&&t.defaultView.pageXOffset||void 0,s=i||o.scrollTop||r.scrollTop,c=l||o.scrollLeft||r.scrollLeft,a=o.clientTop||r.clientTop||0,u=o.clientLeft||r.clientLeft||0;if(e.isUndefinedOrNull(n))return{top:s,left:c};var p=n.getBoundingClientRect(),f=p.top+s-a,d=p.left+c-u;return{top:Math.round(f),left:Math.round(d)}},e}(),c=function(){function e(){var n=this;this.runningInstances=[],this.onInterrupted={report:function(e,t){t.interruptible&&("keyup"!==e.type||l._interruptKeys.indexOf(e.keyCode)>=0)&&n.stopAll(t.namespace)}},e.instanceCounter>0&&t.isDevMode()&&console.warn("An instance of PageScrollService already exists, usually including one provider should be enough, so double check."),e.instanceCounter++}return e.prototype.stopInternal=function(e,t){var n=this.runningInstances.indexOf(t);return n>=0&&this.runningInstances.splice(n,1),t.interruptListenersAttached&&t.detachInterruptListeners(),!!t.timer&&(clearInterval(t.timer),t.fireEvent(!e),!0)},e.prototype.start=function(e){var n=this;if(this.stopAll(e.namespace),null===e.scrollTopSources||0===e.scrollTopSources.length)return void(t.isDevMode()&&console.warn("No ScrollTopSource specified, this ng2-page-scroll does not know which DOM elements to scroll"));var r=!1;e.scrollTopSources.forEach(function(t){s.isUndefinedOrNull(t)||!r&&t.scrollTop&&(e.startScrollTop=t.scrollTop,r=!0)});var o=e.getCurrentOffset();return e.targetScrollTop=Math.round(e.extractScrollTargetPosition().top-o),e.distanceToScroll=e.targetScrollTop-e.startScrollTop,0===e.distanceToScroll?void(t.isDevMode()&&console.log("Scrolling not possible, as we can't get any closer to the destination")):e.duration<=l._interval?(t.isDevMode()&&console.log("Scroll duration shorter that interval length, jumping to target"),e.setScrollTopPosition(e.targetScrollTop),void e.fireEvent(!0)):((e.interruptible||s.isUndefinedOrNull(e.interruptible)&&l.defaultInterruptible)&&e.attachInterruptListeners(this.onInterrupted),e.startTime=(new Date).getTime(),e.endTime=e.startTime+e.duration,e.timer=setInterval(function(e){var t,r=(new Date).getTime(),o=!1;e.endTime<=r?(t=e.targetScrollTop,o=!0):t=Math.round(e.easingLogic.ease(r-e.startTime,e.startScrollTop,e.distanceToScroll,e.duration)),e.setScrollTopPosition(t)||(o=!0),o&&n.stopInternal(!1,e)},l._interval,e),void this.runningInstances.push(e))},e.prototype.stopAll=function(e){var t=this;if(this.runningInstances.length>0){var n=!1;return this.runningInstances.forEach(function(r,o){(s.isUndefinedOrNull(e)||0===e.length||r.namespace===e)&&(n=!0,t.stopInternal(!0,r))}),n}return!1},e.prototype.stop=function(e){return this.stopInternal(!0,e)},e.instanceCounter=0,e.decorators=[{type:t.Injectable}],e.ctorParameters=[],e}(),a=function(){function e(e,n){this._namespace=l._defaultNamespace,this._offset=l.defaultScrollOffset,this._duration=l.defaultDuration,this._easingLogic=l.defaultEasingLogic,this._interruptible=l.defaultInterruptible,this._pageScrollFinish=new t.EventEmitter,this._startScrollTop=0,this._interruptListenersAttached=!1,this._timer=null,this._namespace=e,this.document=n}return e.simpleInstance=function(t,n,r){return e.advancedInstance(t,n,null,r,null,null,null,null)},e.simpleInlineInstance=function(t,n,r,o){return e.advancedInstance(t,n,[r],o,null,null,null,null)},e.advancedInstance=function(t,n,r,o,i,c,a,u,p){void 0===r&&(r=null),void 0===i&&(i=null),void 0===c&&(c=null),void 0===a&&(a=null),void 0===u&&(u=null),void 0===p&&(p=null),(s.isUndefinedOrNull(o)||o.length<=0)&&(o=l._defaultNamespace);var f=new e(o,t);return s.isUndefinedOrNull(r)||0===r.length?(f._isInlineScrolling=!1,f._scrollTopSources=[t.documentElement,t.body,t.body.parentNode]):(f._isInlineScrolling=!0,f._scrollTopSources=r),f._scrollTarget=n,s.isUndefinedOrNull(i)||(f._offset=i),s.isUndefinedOrNull(a)||(f._easingLogic=a),s.isUndefinedOrNull(u)||(f._duration=u),s.isUndefinedOrNull(p)||(f._pageScrollFinish=p),f._interruptible=c||s.isUndefinedOrNull(c)&&l.defaultInterruptible,f},e.prototype.extractScrollTargetPosition=function(){var e;return e="string"==typeof this._scrollTarget?this.document.getElementById(this._scrollTarget.substr(1)):this._scrollTarget,this._isInlineScrolling?{top:e.offsetTop,left:e.offsetLeft}:s.extractElementPosition(this.document,e)},e.prototype.getCurrentOffset=function(){return this._offset},e.prototype.setScrollTopPosition=function(e){return this.scrollTopSources.reduce(function(t,n){return!(!n||s.isUndefinedOrNull(n.scrollTop)||(n.scrollTop=e,n.scrollTop!==e))||t},!1)},e.prototype.fireEvent=function(e){this._pageScrollFinish&&this._pageScrollFinish.emit(e)},e.prototype.attachInterruptListeners=function(e){var t=this;this._interruptListenersAttached&&this.detachInterruptListeners(),this._interruptListener=function(n){e.report(n,t)},l._interruptEvents.forEach(function(e){return t.document.body.addEventListener(e,t._interruptListener)}),this._interruptListenersAttached=!0},e.prototype.detachInterruptListeners=function(){var e=this;l._interruptEvents.forEach(function(t){return e.document.body.removeEventListener(t,e._interruptListener)}),this._interruptListenersAttached=!1},Object.defineProperty(e.prototype,"namespace",{get:function(){return this._namespace},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scrollTopSources",{get:function(){return this._scrollTopSources},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"startScrollTop",{get:function(){return this._startScrollTop},set:function(e){this._startScrollTop=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"targetScrollTop",{get:function(){return this._targetScrollTop},set:function(e){this._targetScrollTop=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"distanceToScroll",{get:function(){return this._distanceToScroll},set:function(e){this._distanceToScroll=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"duration",{get:function(){return this._duration},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"easingLogic",{get:function(){return this._easingLogic},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"interruptible",{get:function(){return this._interruptible},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"startTime",{get:function(){return this._startTime},set:function(e){this._startTime=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"endTime",{get:function(){return this._endTime},set:function(e){this._endTime=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"timer",{get:function(){return this._timer},set:function(e){this._timer=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"interruptListenersAttached",{get:function(){return this._interruptListenersAttached},enumerable:!0,configurable:!0}),e}(),u=function(){function e(e,n,r){this.pageScrollService=e,this.router=n,this.pageScrollOffset=null,this.pageScrollDuration=null,this.pageScrollEasing=null,this.pageScroll=null,this.pageScrollFinish=new t.EventEmitter,this.document=r}return e.prototype.ngOnDestroy=function(){this.pageScrollInstance&&this.pageScrollService.stop(this.pageScrollInstance)},e.prototype.generatePageScrollInstance=function(){return s.isUndefinedOrNull(this.pageScrollInstance)&&(this.pageScrollInstance=a.advancedInstance(this.document,this.href,null,this.pageScroll,this.pageScrollOffset,this.pageScrollInterruptible,this.pageScrollEasing,this.pageScrollDuration,this.pageScrollFinish)),this.pageScrollInstance},e.prototype.handleClick=function(e){var t=this;if(this.routerLink)var r=this.router.events.subscribe(function(e){e instanceof n.NavigationEnd?(r.unsubscribe(),t.pageScrollService.start(t.generatePageScrollInstance())):(e instanceof n.NavigationError||e instanceof n.NavigationCancel)&&r.unsubscribe()});else this.pageScrollService.start(this.generatePageScrollInstance());return!1},e.decorators=[{type:t.Directive,args:[{selector:"[pageScroll]",host:{"(click)":"handleClick($event)"}}]}],e.ctorParameters=[{type:c},{type:n.Router},{type:void 0,decorators:[{type:t.Inject,args:[r.DOCUMENT]}]}],e.propDecorators={routerLink:[{type:t.Input}],href:[{type:t.Input}],pageScrollOffset:[{type:t.Input}],pageScrollDuration:[{type:t.Input}],pageScrollEasing:[{type:t.Input}],pageScrollInterruptible:[{type:t.Input}],pageScroll:[{type:t.Input}],pageScrollFinish:[{type:t.Output}]},e}(),p=function(){function e(){}return e.decorators=[{type:t.NgModule,args:[{imports:[o.CommonModule],declarations:[u],exports:[u],providers:[{provide:c,useClass:c}]}]}],e.ctorParameters=[],e}();e.Ng2PageScrollModule=p,e.PageScroll=u,e.PageScrollService=c,e.EasingLogic=i,e.PageScrollConfig=l,e.PageScrollInstance=a,e.PageScrollUtilService=s,Object.defineProperty(e,"__esModule",{value:!0})});
